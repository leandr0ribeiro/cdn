$(document).ready(function () {
  let divId = $('#status-data-chart');
  let data = $(divId).data('value');

  if (data["data"].length > 0) {
    divId.html('<canvas id="status-chart" style="width: 100%; height: 100%;"></canvas>');
    // Passando as cores diretamente para a função customStatusChart
    let colors = [
      "#cf3e3c", // Falha identificada
      "#efab39", // Em correção
      "#f3d877", // Falha de reteste
      "#800080", // Risco aceito
      "#90C9FC", // Reteste
      "#419582"  // Concluído
    ];
    customStatusChart(data["labels"], data["data"], colors); // Passando as cores diretamente
  }
  else{
    divId.html(
      '<p>Scan sem vulnerabilidades identificadas ou não executado</p>' +
      "<br><br>" +
      '<img src="/static/assets/img/teste-falha.png"' +
      'alt="Ícone de Teste Falha" style="margin-left: 120px">' +
      '<br><br' +
      '<canvas width="100%" height="95%"></canvas>'
    )
  }
});

function customStatusChart(labels, data, colors, chart_type = "pie") {
  let canvasId = "#status-chart"
  let ctx = $(canvasId);

  new Chart(ctx, {
    type: chart_type,
    data: {
      labels: labels,
      datasets: [
        {
          data: data,
          backgroundColor: colors, // Usando as cores passadas diretamente
        },
      ]
    },
    options: {
      plugins: {
        legend: {
          position: 'left',
          labels: {
            font: {
              weight: 'bold'
            }
          },
          padding: 20
        }
      },
    }
  });
}
